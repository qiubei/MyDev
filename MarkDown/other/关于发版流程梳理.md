# 关于发版流程梳理

## 发版相关的测试讨论

### 回归测试
 
回归测试的内容包含以下几点：

1. UI 功能测试
2. 主要业务逻辑测试
3. 第三方服务测``试
4. 不同设备和系统适配测试

针对上面的几点，目前易休 1.x 的回归测试对1、2点的内容作了比较全面的测试，对于3、4点还没形成规范，后面会将入引入并严格按流程测试。

### 单元测试

对于回归测试中的单元测试包含两种：app 内的单元测试和本地库中单元测试。app 内的单元测试可以通过 fastlane 构建流程中的 scan 来实现单元测试；对于本地库中的单元测试，由于外部依赖小，改动小，所以只在改动的情况下手动运行单元测试。

易休 1.x 发版并没有加入单元测试的内容，之后将引入单元测试的内容。

### 规模测试 和 回归测试 探讨

对于规模测试我的理解是模块的规模，模块由少到多，测试也有了单元 -> 中规模测试 -> 大规模测试。如果规模测试像我上面理解的那样的话，我觉得对于我们没有必要显示中规模测试或者大规模测试。理由如下：

1. 模块之间的关联性小，大部分模块只与主线（app）有关。所以组合模块测试意义不大。
2. 我们是阶段的开发，由于阶段性的任务导致我们有阶段性的 dog food，而每次的 dog food 都会有回归测试。所以回归测试可以等价于中等规模测试。
3. 中等规模的实现有一定代价，时间成本，人员成本。并且很大程度上会依赖 app，这样和开发的重叠了。

针对我们目前的项目情况我们的规模测试就由回归测试代替了。

### 发版规则

4种版本形式：

1. weekly build
2. stable build (内测 或 dog food)
3. beta build
4. release build

就目前的开发的情况我们主要是以 stable build 为主，stable build 的发版规则是与阶段（隋、唐、动、元、明、清。。。）相关的，每个阶段发一个 stable build。也就是我们现在的内测版本 （dog food）。

在开发后期，app 的功能开发收尾阶段，会计划发布 beta build。 beta build 通过后，进入release build。

## 发版流程探讨

在阶段性功能完成后进入内测发版阶段，有以下几个点是我们需要考虑的：

1. 通过什么平台分发我们的内容 app ？保证每个人都能用，而且方便下载。
    `在 fir.im 分发平台发布我们的测试 app，通过扫描二维码获取下载连接的方式进入 fir 下载。获取二维码的渠道：1、打印贴在固定地方扫描 2、通过微信群发送。 注意 iOS 需要使用企业证书`

2. 通过什么方式告知大家有测试版本？
    `有两种：微信通知群、邮件。对于已经装过的也可以考虑利用 app 远程推送。`

3. 怎样告诉测试人员测试内容是什么？有没有固定的测试方法？
`在上面通知测试版本的方式中加入需要测试的内容。所以通过微信通知群和邮件的方式发布测试内容。对于某些不可见的测试内容，需要单独的测试方法，如测试音量模型、智能唤醒等，并且这些需要强制性实验。例如公司人员分组进行天实验或者每个人至少一次有效体验数据和正式反馈。`

4. 测试人员怎样反馈发现的 bug？
`我想到有种方式：1、微信发送 2、邮件 3、Instabug 4、直接找人反馈。我分析下优缺点：1、对测试人员操作有点繁琐，对描述问题可能不太准确；责任人只需要记录问题 2、（大公司通常采取这种方式）没有必要，太正式了，我们沟通成本也不是那么大，以后可以考虑使用。3、测试人员操作简单，对描述问题可能不太准确；责任人操作繁琐，需要查看服务器，进行删选，然后记录。4、可以直接了解 bug 本身，复现方式；会打断责任人的工作安排。我建议采用1、4结合。也可以试着用下3。 对于某些特殊的测试，反馈方式出特定方案。`

5. bug 怎样管理？要分等级吗？需不需要进度管理？
`可以使用重新使用 github 中 issues 方式管理，一般一个 bug 有三种状态：未处理、处理、挂起，对应在 github 的是 open 和 closed；可以通过 issue 的标签分等级。对于进度管理可以在周报的时候给个简易版的：只包含有 app 信息、app 版本信息、未处理 bug 数、处理 bug 数、挂起的 bug 数的一个统计表格。`

6. 关于几个时间，什么时候修复 bug，定期？什么发版定期？
`星期五修复 bug。星期一发布内测版本。`

7. 关于新需求与测试版本有什么约束？
`针对有新需求的版本需要延迟一周上线测试，假如在星期二提出一个新需求，在下一个星期一发布的测试版是没有这个新需求内容的。`


## 算法在实际体验中的一些测试内容

关于算法的测试属于特殊的测试，根据上面的流程讨论需要单独的测试方案。并且需要强制性体验。

### 音量控制

#### 测试内容

1. 音量变化，渐小。
2. 音乐变化。
3. 音量反复。
4. 反复时，音乐有什么变化。

#### 测试反馈

1. 出现状态点，渐入佳境时：有没有音量变化
2. 出现第二点：音量更小，音乐停了。只有粉噪声。
3. 中间有没出现音量起伏的情况。
4. 有起伏的情况音乐是怎样变化的。

### 智能唤醒


#### 测试内容

1. 音量变化
2. 通知

#### 测试反馈

1. 出现智能唤醒的点：音量变化
2. 通知情况


[]()

